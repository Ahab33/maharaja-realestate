<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Add Property - Maharaja Builders</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    :root {
      --primary-green: #0d2e1e;
      --secondary-green: #13452a;
      --accent-gold: #d4af37;
      --white: #ffffff;
      --light-gray: #f5f5f5;
      --text-dark: #0d2e1e;
      --text-light: #666;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background: var(--light-gray);
      color: var(--text-dark);
      margin: 0;
    }

    .form-container {
      max-width: 850px;
      margin: 60px auto;
      background: var(--white);
      padding: 50px;
      border-radius: 20px;
      box-shadow: 0 8px 25px rgba(13,46,30,0.1);
    }

    h1 {
      text-align: center;
      color: var(--primary-green);
      margin-bottom: 40px;
    }

    label {
      font-weight: 600;
      display: block;
      margin-top: 20px;
    }

    input, select {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid rgba(13,46,30,0.15);
      border-radius: 10px;
      margin-top: 8px;
      font-family: 'Poppins';
      background: var(--white);
    }

    input:focus, select:focus {
      border-color: var(--primary-green);
      outline: none;
      box-shadow: 0 0 0 3px rgba(13,46,30,0.1);
    }

    .amenities-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 10px;
      margin-top: 15px;
    }

    .amenity-item {
      display: flex;
      align-items: center;
      gap: 10px;
      background: rgba(13,46,30,0.05);
      border-radius: 8px;
      padding: 8px 12px;
    }

    button {
      margin-top: 35px;
      width: 100%;
      padding: 15px;
      background: linear-gradient(135deg, var(--primary-green), var(--secondary-green));
      color: var(--white);
      font-weight: 600;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.3s;
    }

    button:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(13,46,30,0.25);
    }

    .payment-options {
      display: none;
      margin-top: 25px;
      border: 2px dashed rgba(13,46,30,0.2);
      padding: 20px;
      border-radius: 12px;
      background: rgba(13,46,30,0.02);
    }

    .payment-options h3 {
      color: var(--primary-green);
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="form-container">
    <h1><i class="fas fa-plus-circle"></i> Add Property</h1>
    <form id="addPropertyForm">
      <label>Developer</label>
      <select id="developer" required>
        <option value="">Select Developer</option>
        <option value="dha">DHA</option>
        <option value="bahria">Bahria</option>
        <option value="other">Other</option>
      </select>

      <label>Listing Type</label>
      <select id="listingType" required>
        <option value="sale">Sell Property</option>
        <option value="rent">Rent Property</option>
      </select>

      <label>Property Title</label>
      <input type="text" id="title" required>

      <label>City</label>
      <select id="city" required>
        <option value="islamabad">Islamabad</option>
        <option value="lahore">Lahore</option>
        <option value="karachi">Karachi</option>
      </select>

      <label>Price (PKR)</label>
      <input type="number" id="price" required>

      <label>Bedrooms</label>
      <input type="number" id="bedrooms">

      <label>Bathrooms</label>
      <input type="number" id="bathrooms">

      <label>Amenities</label>
      <div class="amenities-list">
        <label class="amenity-item"><input type="checkbox" value="Car Parking"> Car Parking</label>
        <label class="amenity-item"><input type="checkbox" value="Electricity Backup"> Electricity Backup</label>
        <label class="amenity-item"><input type="checkbox" value="Swimming Pool"> Swimming Pool</label>
        <label class="amenity-item"><input type="checkbox" value="Gym"> Gym</label>
        <label class="amenity-item"><input type="checkbox" value="Security System"> Security System</label>
        <label class="amenity-item"><input type="checkbox" value="Park Facing"> Park Facing</label>
      </div>

      <label>Main Image</label>
      <input type="file" id="mainImage" accept="image/*" required>

      <label>Additional Images</label>
      <input type="file" id="extraImages" accept="image/*" multiple>

      <div id="paymentOptions" class="payment-options">
        <h3><i class="fas fa-credit-card"></i> Payment Required</h3>
        <p>Properties outside DHA or Bahria require a listing fee.</p>
        <label><input type="radio" name="payment" value="easypaisa"> Easypaisa</label><br>
        <label><input type="radio" name="payment" value="jazzcash"> JazzCash</label>
      </div>

      <button type="submit"><i class="fas fa-paper-plane"></i> Submit Property</button>
    </form>
  </div>

  <script>
    const developerSelect = document.getElementById('developer');
    const paymentBox = document.getElementById('paymentOptions');

    developerSelect.addEventListener('change', () => {
      paymentBox.style.display = developerSelect.value === 'other' ? 'block' : 'none';
    });

   document.getElementById('addPropertyForm').addEventListener('submit', async (e) => {
  e.preventDefault();

  const developer = document.getElementById('developer').value;
  const listingType = document.getElementById('listingType').value;
  const title = document.getElementById('title').value;
  const city = document.getElementById('city').value;
  const price = document.getElementById('price').value;
  const bedrooms = document.getElementById('bedrooms').value;
  const bathrooms = document.getElementById('bathrooms').value;
  const amenities = Array.from(document.querySelectorAll('.amenities-list input:checked')).map(a => a.value);

  if (developer === 'other' && !document.querySelector('input[name="payment"]:checked')) {
    alert('Please select a payment method.');
    return;
  }

  const propertyData = {
    title,
    developer,
    city,
    price: `PKR ${price}`,
    type: listingType === 'rent' ? 'rental' : 'sale',
    bedrooms,
    bathrooms,
    area: 'N/A',
    amenities,
    image: 'https://i.pinimg.com/736x/c4/ee/a4/c4eea4906647b7c01cc0e9f98862f9ce.jpg',
    images: [
      'https://picsum.photos/300/200?random=10',
      'https://picsum.photos/300/200?random=11'
    ]
  };

  try {
    const res = await fetch('http://localhost:5000/api/properties', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(propertyData)
    });
    if (!res.ok) throw new Error('Failed to add property');
    alert('✅ Property added successfully!');
    window.location.href = listingType === 'sale' ? 'buy.html' : 'rent.html';
  } catch (err) {
    alert('❌ Error adding property. Check console.');
    console.error(err);
  }
});

  </script>
</body>
</html>
